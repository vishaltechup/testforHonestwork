<!-- <div class="container-fluid">
    <app-statistics></app-statistics> -->

<section class="pt-5">
    <div class="md:flex">
        <div class="md:w-full">
            <div class="project-banner">
                <div class="pt-4">
                    <app-tabs></app-tabs>
                    <section aria-labelledby="tab4-label">
                        <div class="p-4">
                            <div class="md:flex justify-between">
                                <form [formGroup]="taskStatusForm" method="post" class="form-horizontal">
                                    <div class="md:flex">
                                        <div class="pr-2 m-pr-0 mt-1">
                                            <select name="viewas" formControlName="viewas" id="viewas"
                                                (change)="OnChangeviewas($event.target.value)"
                                                class="select-dropdown-design">
                                                <option value="">View as : List</option>
                                                <option value="Grid">View As : Grid</option>
                                            </select>
                                        </div>

                                        <div class="pl-2 m-pl-0 mt-1">
                                            <select formControlName="filterby" name="filterby" id="filterby"
                                                class="select-dropdown-design" (change)="filterPriority($event)">
                                                <option value="0">Show All</option>
                                                <option *ngFor="let tag of Taglist" [value]="tag.id">
                                                    {{tag.name}}</option>
                                            </select>

                                        </div>
                                        <div class="pl-2 m-pl-0 mt-1">
                                            <select name="viewas" id="viewas" class="select-dropdown-design pr-2 m-pr-1"
                                                (change)="filterData($event)">
                                                <option value="1">Active</option>
                                                <option value="2">Inactive</option>
                                                <option value="3">Close</option>
                                            </select>
                                        </div>
                                    </div>

                                </form>
                                <div style="text-align: right;">
                                    <button style="cursor: pointer;" (click)="htmlAddModal.show();openModal()"
                                        *ngIf="permissions.addtask.canView"
                                        class="mt-3 new-project-btn primary-btn font-size-16 primary-btn-text-color font-medium tracking-normal text-center">
                                        Add Task
                                    </button>
                                </div>
                            </div>
                            <div class="mt-3">
                                <!-- <div class="mt-3">
                                    <span class="font-size-14 child-text-color font-medium tracking-normal">
                                    </span>
                                </div> -->
                                <div class="md:w-full md:flex md:flex-wrap" *ngIf="taskList && taskList.length>0">
                                    <div *ngFor="let task of taskList"
                                        [ngClass]="viewasstatus ? 'md:w-1/3' : 'col-md-12 mt-2 md:flex'"
                                        class="items-center m-block main-border-box my-2">
                                        <!-- <div [ngClass]="viewasstatus ? 'col-md-4 mx-auto' : 'col-md-12 mt-2 md:flex'"
                                            class="items-center m-block main-border-box"> -->
                                        <div [ngClass]="viewasstatus ? '' : 'md:w-4/5'"
                                            class="pr-5 m-pr-0 end-border-right"
                                            style="border-right: 1px solid #adadad;">
                                            <div [ngClass]="viewasstatus ? '' : 'flex'" class="m-block items-center">
                                                <div [ngClass]="viewasstatus ? '' : 'flex-basis'"
                                                    class="border-right-icon m-center">
                                                    <div [ngClass]="viewasstatus ? 'col-md-1 mt-5' : 'flex'"
                                                        class="justify-center items-center">
                                                        <img src="../../../assets/img/card.svg" />
                                                    </div>
                                                </div>
                                                <div class="pl-8 m-pl-0" [ngClass]="viewasstatus ? '' : 'md:w-4/5'">
                                                    <div class="pl-2 inner-box">
                                                        <div [ngClass]="viewasstatus ? '' : 'flex'"
                                                            class="m-block items-center">
                                                            <div class="row w-full">
                                                                <div class="col-md-12">
                                                                    <div class="col-md-6">
                                                                        <p
                                                                            class="font-size-14 tracking-normal child-text-color font-medium mb-0">
                                                                            Assigned to </p>
                                                                        <p class="font-size-18 tracking-normal font-normal heading-title-text-color mb-0"
                                                                            style="text-align:left !important;">
                                                                            <b>{{task.workerName}}</b>
                                                                        </p>
                                                                    </div>


                                                                    <div class="col-md-3">
                                                                        <p
                                                                            class="font-size-14 tracking-normal child-text-color font-medium mb-0">
                                                                            Estimated hours </p>
                                                                        <p class="font-size-18 tracking-normal font-normal heading-title-text-color mb-0"
                                                                            style="text-align:inherit !important;">
                                                                            <b>{{task.estimatedHours}}</b>
                                                                        </p>
                                                                    </div>


                                                                </div>
                                                                <div class="d-flex flex-wrap">
                                                                    <span *ngFor="let tag of task.tagList"
                                                                        style="border-radius: 5px;padding: 5px; margin-right: 5px;"
                                                                        [ngStyle]="{'background-color': tag.tagColor,'color':'white','font-size':'10px'}"
                                                                        class="m-w-full tracking-normal font-bold text-center">
                                                                        {{tag.tagName}}
                                                                    </span>
                                                                </div>
                                                                <div class="col-md-12 mt-3">
                                                                    <p
                                                                        class="font-size-14 tracking-normal child-text-color font-medium mb-0">
                                                                        Task </p>
                                                                    <p *ngIf="task.task.length<=60"
                                                                        [innerHtml]="task.task"
                                                                        class="font-size-16 tracking-normal heading-title-text-color mb-0 font-normal"
                                                                        style="text-align:inherit !important;">
                                                                    </p>
                                                                    <div *ngIf="task.task.length>60"
                                                                        class="font-size-16 tracking-normal heading-title-text-color mb-0 font-normal"
                                                                        style="text-align:inherit !important;">
                                                                        {{task.task.slice(0, 60)}}
                                                                        <b style="cursor: pointer;color: blue;"
                                                                            (click)="htmlDescriptionModal.show()">Read
                                                                            more...</b>

                                                                        <div bsModal
                                                                            [config]="{backdrop: 'static',  keyboard: false}"
                                                                            class="modal fade"
                                                                            #htmlDescriptionModal="bs-modal"
                                                                            tabindex="-1" role="dialog"
                                                                            aria-labelledby="myModalLabel"
                                                                            aria-hidden="true" data-toggle="modal"
                                                                            data-target="#exampleModalScrollable">
                                                                            <div class="modal-dialog"
                                                                                role="document">
                                                                                <div class="modal-content">


                                                                                    <div class="modal-header">
                                                                                        <h4 class="modal-title">
                                                                                            <b>Task
                                                                                                Details</b>
                                                                                        </h4>
                                                                                        <button type="button"
                                                                                            class="close"
                                                                                            (click)="htmlDescriptionModal.hide()"
                                                                                            aria-label="Close">
                                                                                            <span
                                                                                                aria-hidden="true">&times;</span>
                                                                                        </button>
                                                                                    </div>

                                                                                    <div class="modal-body">
                                                                                        <div class="col col-md-12">
                                                                                            <div class="lg:flex"
                                                                                                style="word-break: break-word;">
                                                                                                {{task.task}}
                                                                                            </div>

                                                                                        </div>
                                                                                        <div class="modal-footer">
                                                                                            <button type="button"
                                                                                                class="new-project-btn primary-btn font-size-18 primary-btn-text-color font-medium tracking-normal text-center"
                                                                                                (click)="htmlDescriptionModal.hide()"
                                                                                                aria-label="Close">Cancel</button>

                                                                                        </div>
                                                                                    </div>

                                                                                </div>
                                                                            </div>
                                                                        </div>

                                                                    </div>

                                                                </div>
                                                                <!-- for description -->
                                                                <div class="col-md-12 mt-3">
                                                                    <p
                                                                        class="font-size-14 tracking-normal child-text-color font-medium mb-0">
                                                                        Description </p>
                                                                    <p *ngIf="task.taskDescription.length<=60"
                                                                        [innerHtml]="task.taskDescription"
                                                                        class="font-size-18 tracking-normal heading-title-text-color mb-0 font-normal"
                                                                        style="text-align:inherit !important;">
                                                                    </p>

                                                                    <!-- for more than 60 words in description -->
                                                                    <div *ngIf="task.taskDescription.length>60"
                                                                        class="font-size-18 tracking-normal heading-title-text-color mb-0 font-normal"
                                                                        style="text-align:inherit !important;">
                                                                        {{task.taskDescription.slice(0,
                                                                        60)}}
                                                                        <b style="cursor: pointer;color: blue;"
                                                                            (click)="htmltaskDescriptionModal.show()">...Read
                                                                            more</b>

                                                                        <div bsModal
                                                                            [config]="{backdrop: 'static',  keyboard: false}"
                                                                            class="modal fade"
                                                                            #htmltaskDescriptionModal="bs-modal"
                                                                            tabindex="-1" role="dialog"
                                                                            aria-labelledby="myModalLabel"
                                                                            aria-hidden="true" data-toggle="modal"
                                                                            data-target="#exampleModalScrollable">
                                                                            <div class="modal-dialog modal-lg"
                                                                                role="document">
                                                                                <div class="modal-content">
                                                                                    <div class="modal-header">
                                                                                        <h4 class="modal-title">
                                                                                            <b>Task
                                                                                                Description</b>
                                                                                        </h4>
                                                                                        <button type="button"
                                                                                            class="close"
                                                                                            (click)="htmltaskDescriptionModal.hide()"
                                                                                            aria-label="Close">
                                                                                            <span
                                                                                                aria-hidden="true">&times;</span>
                                                                                        </button>
                                                                                    </div>

                                                                                    <div class="modal-body">
                                                                                        <div class="col col-md-12">
                                                                                            <div class="lg:flex">
                                                                                                {{task.taskDescription}}
                                                                                            </div>

                                                                                        </div>
                                                                                        <div class="modal-footer">
                                                                                            <button type="button"
                                                                                                class="new-project-btn primary-btn font-size-18 primary-btn-text-color font-medium tracking-normal text-center"
                                                                                                (click)="htmltaskDescriptionModal.hide()"
                                                                                                aria-label="Close">Cancel</button>

                                                                                        </div>
                                                                                    </div>

                                                                                </div>
                                                                            </div>
                                                                        </div>

                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div [ngClass]="viewasstatus ? 'mt-2 md:ml-8' : 'md:w-1/5'"
                                            class="pl-3 m-pl-0 m-mt-2">
                                            <select name="statusId" id="statusId" [ngClass]="viewasstatus ? 'mt-2' : ''"
                                                (change)="UpdateProjectTaskStatus(task.statusId,task.id)"
                                                [(ngModel)]="task.statusId" class="select-dropdown-design">
                                                <option value="">Select status</option>
                                                <option *ngFor="let status of Statuslist" [value]="status.id">
                                                    {{status.name}}</option>
                                            </select>
                                            <button style="cursor: pointer;" (click)="CloseTask(task)"
                                                class="mt-3 new-project-btn primary-btn font-size-16 primary-btn-text-color font-medium tracking-normal text-center">
                                                Close Task
                                            </button>
                                        </div>
                                    </div>
                                    <!-- </div> -->

                                </div>


                                <div class="row" *ngIf="taskList && taskList==0" style="text-align: center;">
                                    <span><b>No record (s) to show </b></span>
                                </div>

                                <!-- <div class="col-md-12 mb-4">
                                        <form [formGroup]="taskForm" method="post" class="form-horizontal"
                                            *ngIf="permissions.addmilestone.canView">
                                            <div class="lg:flex-full mt-4">
                                                <div class="md:flex">

                                                    <div class="md:w-1/5 pl-2 m-pl-0 m-mt-2">
                                                        <input formControlName="task" class="input-form-control"
                                                            type="text" placeholder="Task Title..." />
                                                        <p class="help-block"
                                                            *ngIf="submitAttempt && taskForm.controls.task.errors?.required">
                                                            Task title is required
                                                        </p>
                                                    </div>
                                                    <div class="md:w-1/5 pl-2 m-pr-0">
                                                        <select formControlName="projectMileStoneId"
                                                            name="projectMileStoneId" id="projectMileStoneId"
                                                            class="select-dropdown-design">
                                                            <option value="">Select milestone</option>
                                                            <option *ngFor="let milestone of Milestonelist"
                                                                [value]="milestone.id">{{milestone.name}}</option>
                                                        </select>

                                                        <p class="help-block"
                                                            *ngIf="submitAttempt && taskForm.controls.projectMileStoneId.errors?.required">
                                                            Milestone is required
                                                        </p>
                                                    </div>
                                                    <div class="pl-2 pr-2 m-pr-0 text-right" style="display:none">
                                                        <button (click)="addMilestone()" title="Add milestone"
                                                            class="new-project-btn primary-btn font-size-18 primary-btn-text-color font-medium tracking-normal text-center">
                                                            <i class="fas fa-plus white-icon-color"></i> </button>

                                                    </div>
                                                    <div class="md:w-1/5 pl-2 m-pl-0 m-mt-2">
                                                        <select formControlName="WorkerId"
                                                            class="select-dropdown-design">
                                                            <option value="">Select worker</option>
                                                            <option *ngFor="let worker of Workerslist"
                                                                [value]="worker.id">
                                                                {{worker.name}}</option>
                                                        </select>
                                                        <p class="help-block"
                                                            *ngIf="submitAttempt && taskForm.controls.WorkerId.errors?.required">
                                                            Worker is required
                                                        </p>
                                                    </div>
                                                    <div class="md:w-1/5 pl-2 m-pl-0 m-mt-2">
                                                        <input formControlName="estimatedHours" maxlength="4"
                                                            mask="0*.00" class="input-form-control" type="text"
                                                            placeholder="Estimated hours..." />
                                                        <p class="help-block"
                                                            *ngIf="submitAttempt && taskForm.controls.estimatedHours.errors?.required">
                                                            Estimated hours is required
                                                        </p>
                                                    </div>
                                                    <div class="md:w-1/5 pl-2 m-pl-0 m-mt-2">
                                                        <select formControlName="tagId" name="tagId" id="tagId"
                                                            class="select-dropdown-design">
                                                            <option value="">Select tag</option>
                                                            <option *ngFor="let tag of Taglist" [value]="tag.id">
                                                                {{tag.name}}</option>
                                                        </select>
                                                        <p class="help-block"
                                                            *ngIf="submitAttempt && taskForm.controls.tagId.errors?.required">
                                                            Tag is required
                                                        </p>
                                                    </div>
                                                    <div class="pl-2 pr-2 m-pr-0 text-right">
                                                        <button (click)="AddProjectTask();"
                                                            class="new-project-btn primary-btn font-size-18 primary-btn-text-color font-medium tracking-normal text-center"
                                                            title="Add task">
                                                            <i class="fas fa-plus white-icon-color"></i> </button>

                                                    </div>
                                                </div>
                                            </div>
                                        </form>
                                    </div> -->

                                <div class="col-md-12 mb-4 flex ml-2">
                                    <div class="lg:flex-full mt-4">
                                        <div class="md:flex">
                                            <div *ngIf="pager?.pages?.length>1">
                                                <ul *ngIf="pager.pages && pager?.pages?.length"
                                                    class="mb-5 pagination-prev page-item pagination">
                                                    <li [ngClass]="{disabled:pager.currentPage === 1}"
                                                        class="pagination-first page-item">
                                                        <a class="page-link" style="cursor: pointer;"
                                                            *ngIf="pager.currentPage > 1"
                                                            (click)="gettasklistbyprojectid(1)">First</a>
                                                        <a class="page-link" *ngIf="pager.currentPage === 1">First</a>
                                                    </li>
                                                    <li [ngClass]="{disabled:pager.currentPage === 1}"
                                                        class="pagination-prev page-item">
                                                        <a class="page-link" style="cursor: pointer;"
                                                            *ngIf="pager.currentPage > 1"
                                                            (click)="gettasklistbyprojectid(pager.currentPage - 1)">Previous</a>
                                                        <a class="page-link"
                                                            *ngIf="pager.currentPage === 1">Previous</a>
                                                    </li>
                                                    <li *ngFor="let page of pager.pages"
                                                        [ngClass]="{active:pager.currentPage === page}"
                                                        class="pagination-page page-item">
                                                        <a class="page-link" style="cursor: pointer;"
                                                            (click)="gettasklistbyprojectid(page)">{{page}}</a>
                                                    </li>
                                                    <li [ngClass]="{disabled:pager.currentPage === pager.totalPages}"
                                                        class="pagination-next page-item">
                                                        <a class="page-link" style="cursor: pointer;"
                                                            *ngIf="pager.totalPages > pager.currentPage"
                                                            (click)="gettasklistbyprojectid(pager.currentPage + 1)">Next</a>
                                                        <a class="page-link"
                                                            *ngIf="pager.currentPage === pager.totalPages">Next</a>
                                                    </li>
                                                    <li [ngClass]="{disabled:pager.currentPage === pager.totalPages}"
                                                        class="pagination-last page-item">
                                                        <a class="page-link" style="cursor: pointer;"
                                                            *ngIf="pager.totalPages > pager.currentPage"
                                                            (click)="gettasklistbyprojectid(pager.totalPages)">Last</a>
                                                        <a class="page-link"
                                                            *ngIf="pager.currentPage === pager.totalPages">Last</a>
                                                    </li>
                                                </ul>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                            </div>
                        </div>

                    </section>
                </div>
            </div>
        </div>
    </div>
</section>
<!-- </div> -->


<!--Model Start Here-->
<div style="margin-bottom: 20px" bsModal [config]="{backdrop: 'static',  keyboard: false}" class="modal fade" #htmlAddModal="bs-modal" tabindex="-1"
    role="dialog" aria-labelledby="myModalLabel" aria-hidden="true" data-toggle="modal"
    data-target="#exampleModalScrollable">
    <div style="overflow-y: initial; ;" class="modal-dialog modal-lg" role="document">
        <div class="modal-content " >

            <form [formGroup]="taskForm" method="post" class="form-horizontal">

                <div class="modal-header">
                    <h4 class="modal-title"><b>Add Task</b></h4>
                    <button type="button" class="close" (click)="htmlAddModal.hide()" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>

                <div class="modal-body" style="overflow-y: auto; height: 80vh;">
                    <div class="lg:flex md:flex">
                        <div class="w-full">
                            <label class="form-label" for="">Task Title</label>
                            <input class="label" formControlName="task" class="input-form-control" type="text"
                                placeholder="Task Title..." />
                            <p class="error-text" *ngIf="submitAttempt && taskForm.controls.task.errors?.required">
                                Task title is required
                            </p>
                        </div>
                    </div>
                    <div class="lg:flex md:flex mt-2">
                        <div class="md:w-1/2">
                            <label class="form-label" for="">Milestone</label>
                            <select formControlName="projectMileStoneId" name="projectMileStoneId"
                                id="projectMileStoneId" class="select-dropdown-design">
                                <option value="">Select milestone</option>
                                <option *ngFor="let milestone of Milestonelist" [value]="milestone.id">
                                    {{milestone.name}}</option>
                            </select>

                            <p class="error-text"
                                *ngIf="submitAttempt && taskForm.controls.projectMileStoneId.errors?.required">
                                Milestone is required
                            </p>
                        </div>

                        <div class="md:w-1/2 ml-2">
                            <label class="form-label" for="">Workers</label>
                            <select formControlName="WorkerId" class="select-dropdown-design">
                                <option value="">Select worker</option>
                                <option *ngFor="let worker of Workerslist" [value]="worker.id">
                                    {{worker.name}}</option>
                            </select>
                            <p class="error-text" *ngIf="submitAttempt && taskForm.controls.WorkerId.errors?.required">
                                Worker is required
                            </p>
                        </div>
                    </div>
                    <div class="lg:flex md:flex mt-2">
                        <div class="md:w-1/2">
                            <label class="form-label" for="">Estimated hours</label>
                            <input formControlName="estimatedHours" maxlength="4" mask="0*.00"
                                class="input-form-control label" type="text" placeholder="Estimated hours..." />
                            <p class="error-text"
                                *ngIf="submitAttempt && taskForm.controls.estimatedHours.errors?.required">
                                Estimated hours is required
                            </p>
                        </div>
                        <div class="md:w-1/2 ml-2">
                            <label class="form-label" for="">Status</label>
                            <select formControlName="taskStatusId" name="taskStatusId" id="taskStatusId"
                                class="select-dropdown-design">
                                <option value="">Select Status</option>
                                <option *ngFor="let status of Statuslist" [value]="status.id">
                                    {{status.name}}</option>
                            </select>
                            <p class="error-text"
                                *ngIf="submitAttempt && taskForm.controls.taskStatusId.errors?.required">
                                Status is required
                            </p>
                        </div>
                    </div>
                    <div class="lg:flex md:flex mt-2">
                        <div class="md:w-1/2">
                            <label class="form-label" for="">Tag</label>
                            <!-- <select formControlName="tagId" name="tagId" id="tagId" class="select-dropdown-design">
                            <option value="">Select tag</option>
                            <option *ngFor="let tag of Taglist" [value]="tag.id">
                                {{tag.name}}</option>
                        </select> -->
                            <ng-multiselect-dropdown [placeholder]="'Select tags'" formControlName="tagId"
                                [settings]="dropdownSettings" [data]="taskTagList" [(ngModel)]="selectedItems"
                                name="tags" (onSelect)="onItemSelect($event)" (onSelectAll)="onSelectAll($event)">
                            </ng-multiselect-dropdown>
                            <p class="error-text" *ngIf="submitAttempt && taskForm.controls.tagId.errors?.required">
                                Tag is required
                            </p>
                        </div>
                        <div class="md:w-1/2 ml-2">
                            <label class="form-label" for="">Priority</label>
                            <select formControlName="priorityId" name="viewas" id="viewas"
                                class="select-dropdown-design">
                                <option value="" selected disabled>Priority</option>
                                <option *ngFor="let priority of priorityList" value="{{priority.id}}">
                                    {{priority.name}}
                                </option>
                            </select>
                            <p class="error-text"
                                *ngIf="submitAttempt && taskForm.controls.priorityId.errors?.required">
                                Priority is required
                            </p>
                        </div>
                    </div>
                    <div class="w-full mt-2">
                        <label class="form-label " for="">Description</label>
                        <textarea class="input-form-control " rows="5" formControlName="TaskDescription"
                            name="TaskDescription" id="TaskDescription" placeholder="Task description"></textarea>
                        <p class="error-text"
                            *ngIf="submitAttempt && taskForm.controls.TaskDescription.errors?.required">
                            Description is required
                        </p>
                    </div>
                    <div style="display: flex; justify-content: end;">
                    <button (click)="AddProjectTask();" 
                            class="new-project-btn primary-btn font-size-16 primary-btn-text-color font-medium tracking-normal text-center"
                            title="Add task">
                            Submit </button>
                            </div>
                    <!-- </div> -->
                    <!-- <div class="modal-footer"> -->
                        <!-- <button type="button"
                            class="new-project-btn primary-btn font-size-18 primary-btn-text-color font-medium tracking-normal text-center"
                            (click)="htmlAddModal.hide()" aria-label="Close">Cancel</button> -->
                        
                    <!-- </div> -->
                </div>
            </form>
        </div><!-- /.modal-content -->
    </div><!-- /.modal-dialog -->
</div><!-- /.modal ends here -->

<app-chat-room></app-chat-room>